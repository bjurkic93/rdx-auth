<section class="card">
  <div class="card__header">
    <h1>Create your password</h1>
    <p>Finish setting up your account by choosing a strong password.</p>
  </div>

  <div class="alert alert--success" *ngIf="successMessage">
    {{ successMessage }}
  </div>
  <div class="alert alert--error" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>
  <div class="alert alert--error" *ngIf="passwordsMismatch">
    Passwords must match.
  </div>

  <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()" novalidate class="form">
    <label class="field">
      <span class="field__label">Email</span>
      <input type="email" [value]="email" disabled />
    </label>

    <label class="field">
      <span class="field__label">Password</span>
      <input
        type="password"
        formControlName="password"
        placeholder="Create a password"
        autocomplete="new-password"
        [class.invalid]="passwordForm.controls.password.touched && passwordForm.controls.password.invalid"
      />
      <span class="field__hint" *ngIf="passwordForm.controls.password.touched && passwordForm.controls.password.hasError('required')">
        Password is required.
      </span>
      <span class="field__hint" *ngIf="passwordForm.controls.password.touched && passwordForm.controls.password.hasError('minlength')">
        Password must be at least 8 characters.
      </span>
    </label>

    <label class="field">
      <span class="field__label">Confirm password</span>
      <input
        type="password"
        formControlName="confirmPassword"
        placeholder="Confirm your password"
        autocomplete="new-password"
        [class.invalid]="passwordForm.controls.confirmPassword.touched && passwordForm.controls.confirmPassword.invalid"
      />
      <span class="field__hint" *ngIf="passwordForm.controls.confirmPassword.touched && passwordForm.controls.confirmPassword.hasError('required')">
        Confirmation is required.
      </span>
      <span class="field__hint" *ngIf="passwordForm.controls.confirmPassword.touched && passwordForm.controls.confirmPassword.hasError('minlength')">
        Password must be at least 8 characters.
      </span>
    </label>

    <button type="submit" class="button" [disabled]="passwordForm.invalid || isSubmitting">
      {{ isSubmitting ? 'Saving...' : 'Save password' }}
    </button>
  </form>

  <p class="card__footer">
    Need a new code?
    <a routerLink="/verify-email" [queryParams]="{ email }">Resend verification</a>.
  </p>
</section>
